---
title: Bastion Recovery System - Chain of Trust
---

%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#1a1a2e',
    'primaryTextColor': '#eee',
    'primaryBorderColor': '#4a4a6a',
    'lineColor': '#666',
    'secondaryColor': '#16213e',
    'tertiaryColor': '#0f3460',
    'background': '#0a0a0a'
  }
}}%%

flowchart TD
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% RELATIONSHIP LEGEND
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% Arrow Types:
    %%   â•â•>  DERIVES FROM  - Cryptographic derivation
    %%   -->  CONTAINS      - Physical containment
    %%   -.-> UNLOCKS       - Enables access to
    %%   ==>  VERIFIES      - Authenticates/validates
    %%   -.-  LOCATED AT    - Physical location reference
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PHASE 1: ROOT OF TRUST
    %% The master seed is the single root from which all secrets derive
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    subgraph PHASE1[" ğŸ” Phase 1: Root of Trust "]
        direction TB
        SEED[/"ğŸŒ± SLIP-39 Master Seed<br/>256-bit entropy"/]
        PASSPHRASE[/"ğŸ”‘ Optional Passphrase<br/>25th word equivalent"/]
    end

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PHASE 2: CRYPTOGRAPHIC DERIVATION
    %% All keys and secrets derive deterministically from the seed
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    subgraph PHASE2[" ğŸ”§ Phase 2: Cryptographic Derivation "]
        direction TB
        
        subgraph SHAMIR[" Shamir Secret Sharing "]
            SPLIT[["âš¡ SLIP-39 Split<br/>Threshold: 3 of 5"]]
        end
        
        subgraph KEYDERIV[" Key Derivation Functions "]
            KDF_ARCHIVE[["ğŸ” HKDF-SHA512<br/>context: archive-encryption"]]
            KDF_YUBIPIN[["ğŸ” HKDF-SHA512<br/>context: yubikey-pin"]]
            KDF_SIGNING[["ğŸ” HKDF-SHA512<br/>context: gpg-signing"]]
        end
    end

    SEED ==>|derives| SPLIT
    SEED ==>|derives| KDF_ARCHIVE
    SEED ==>|derives| KDF_YUBIPIN
    SEED ==>|derives| KDF_SIGNING

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PHASE 3: PHYSICAL ARTIFACTS
    %% Tangible items that store or protect secrets
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    subgraph PHASE3[" ğŸ“¦ Phase 3: Physical Artifacts "]
        direction TB
        
        subgraph METALSHARES[" ğŸª™ Metal Share Plates "]
            S1["Share 1<br/>ğŸ“ Home Safe"]
            S2["Share 2<br/>ğŸ“ Bank Safe"]
            S3["Share 3<br/>ğŸ“ Custodian A"]
            S4["Share 4<br/>ğŸ“ Custodian B"]
            S5["Share 5<br/>ğŸ“ Attorney"]
        end
        
        subgraph SDCARDS[" ğŸ’¾ MicroSD Cards "]
            SD1["SD Card Î±<br/>LUKS2 Archive"]
            SD2["SD Card Î²<br/>LUKS2 Archive"]
            SD3["SD Card Î³<br/>LUKS2 Archive"]
        end
        
        subgraph HARDWARE[" ğŸ”§ Hardware Security "]
            YUBIKEY["ğŸ”‘ YubiKey 5 Nano<br/>USB-A â€¢ FIDO2/OATH"]
            AIRGAP["ğŸ’» Airgapped SBC<br/>ARM â€¢ USB-A ports"]
        end
    end

    SPLIT -->|encodes| S1
    SPLIT -->|encodes| S2
    SPLIT -->|encodes| S3
    SPLIT -->|encodes| S4
    SPLIT -->|encodes| S5

    KDF_ARCHIVE -->|encrypts| SD1
    KDF_ARCHIVE -->|encrypts| SD2
    KDF_ARCHIVE -->|encrypts| SD3

    KDF_YUBIPIN -.->|unlocks| YUBIKEY
    KDF_SIGNING -->|derives| GPG_KEY

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PHASE 4: RECOVERY BAGS
    %% Tamper-evident distribution units
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    subgraph PHASE4[" ğŸ’ Phase 4: Recovery Bags "]
        direction TB
        
        subgraph BAGCONTENTS[" Bag Contents Standard "]
            CONTENTS["â€¢ Metal share plate<br/>â€¢ MicroSD card<br/>â€¢ YubiKey backup<br/>â€¢ Humidity indicator<br/>â€¢ Recovery guide<br/>â€¢ 1P Emergency Kit"]
        end
        
        subgraph BAGS[" ğŸ“ Distribution Locations "]
            B1["ğŸ  Bag 1: HOME<br/>Serial: B1-2025-001"]
            B2["ğŸ¦ Bag 2: BANK<br/>Serial: B2-2025-001"]
            B3["ğŸ‘¤ Bag 3: CUSTODIAN-A<br/>Serial: B3-2025-001"]
        end
    end

    S1 -->|contains| B1
    S2 -->|contains| B2
    S3 -->|contains| B3

    SD1 -->|contains| B1
    SD2 -->|contains| B2
    SD3 -->|contains| B3

    YUBIKEY -.->|backup in| B1
    YUBIKEY -.->|backup in| B2
    YUBIKEY -.->|backup in| B3

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PHASE 5: VERIFICATION & AUDIT
    %% Trust anchors and audit trail
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    subgraph PHASE5[" âœ… Phase 5: Verification "]
        direction TB
        
        subgraph SIGNING[" ğŸ” Cryptographic Signing "]
            GPG_KEY["ğŸ”‘ GPG Signing Key<br/>Ed25519"]
            MANIFEST["ğŸ“‹ Signed Manifest<br/>bag-manifest.sig"]
        end
        
        subgraph ANCHORING[" âš“ Trust Anchoring "]
            OTS["â° OpenTimestamps<br/>Bitcoin merkle proof"]
            SIGCHAIN["ğŸ”— Sigchain<br/>Append-only audit log"]
        end
        
        subgraph ONEP[" ğŸ” 1Password Metadata "]
            PHOTOS["ğŸ“¸ Seal Photos<br/>Before/after states"]
            RECORDS["ğŸ“ Bag Records<br/>Serial â€¢ Location â€¢ Date"]
        end
    end

    GPG_KEY ==>|signs| MANIFEST
    MANIFEST ==>|anchored| OTS
    MANIFEST ==>|logged| SIGCHAIN

    B1 ==>|documented| PHOTOS
    B2 ==>|documented| PHOTOS
    B3 ==>|documented| PHOTOS

    PHOTOS -->|stored| RECORDS

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% PHASE 6: EMERGENCY RECOVERY
    %% The recovery procedure when needed
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    subgraph PHASE6[" ğŸš¨ Phase 6: Emergency Recovery "]
        direction TB
        
        subgraph COLLECTION[" ğŸ“¥ Artifact Collection "]
            COLLECT["Collect 3+ bags<br/>Verify seals intact"]
        end
        
        subgraph RECONSTRUCTION[" ğŸ”„ Reconstruction "]
            COMBINE["âš¡ Combine Shares<br/>SLIP-39 reconstruct"]
            REDERIVE["ğŸ” Re-derive Keys<br/>Archive + YubiKey PIN"]
            DECRYPT["ğŸ“‚ Decrypt Archive<br/>LUKS2 unlock"]
        end
        
        subgraph RESTORED[" âœ¨ Restored Assets "]
            R_1P["ğŸ” 1Password Export"]
            R_GPG["ğŸ”‘ GPG Keyring"]
            R_DOCS["ğŸ“„ Estate Documents"]
            R_CRYPTO["â‚¿ Crypto Wallets"]
        end
    end

    B1 -.->|opens| COLLECT
    B2 -.->|opens| COLLECT
    B3 -.->|opens| COLLECT

    COLLECT --> COMBINE
    COMBINE --> REDERIVE
    REDERIVE --> DECRYPT

    DECRYPT -->|extracts| R_1P
    DECRYPT -->|extracts| R_GPG
    DECRYPT -->|extracts| R_DOCS
    DECRYPT -->|extracts| R_CRYPTO

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% CUSTODIAN CHAIN
    %% Legal and procedural framework
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    subgraph CUSTODY[" âš–ï¸ Custodian Chain "]
        direction LR
        
        OWNER["ğŸ‘¤ Owner<br/>Primary control"]
        SUCCESSOR["ğŸ‘¥ Successor<br/>Upon incapacity"]
        EXECUTOR["âš–ï¸ Executor<br/>Upon death"]
        
        OWNER -->|"incapacity"| SUCCESSOR
        SUCCESSOR -->|"death"| EXECUTOR
    end

    CUSTODY -.->|"governs access"| PHASE4

    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    %% STYLING
    %% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    classDef phase fill:#1a1a2e,stroke:#4a4a6a,stroke-width:2px,color:#fff
    classDef seed fill:#2d4a22,stroke:#4a7a3a,stroke-width:3px,color:#fff
    classDef crypto fill:#1e3a5f,stroke:#3a6a9f,stroke-width:2px,color:#fff
    classDef physical fill:#4a3a2a,stroke:#8a6a4a,stroke-width:2px,color:#fff
    classDef bag fill:#3a2a4a,stroke:#6a4a8a,stroke-width:2px,color:#fff
    classDef verify fill:#2a3a3a,stroke:#4a6a6a,stroke-width:2px,color:#fff
    classDef recover fill:#4a2a2a,stroke:#8a4a4a,stroke-width:2px,color:#fff
    classDef custody fill:#3a3a2a,stroke:#6a6a4a,stroke-width:2px,color:#fff

    class PHASE1 seed
    class PHASE2 crypto
    class PHASE3 physical
    class PHASE4 bag
    class PHASE5 verify
    class PHASE6 recover
    class CUSTODY custody
